{"version":3,"file":"decompose.cjs","sources":["../src/decompose.ts"],"sourcesContent":["import { DELIMITER } from './constants/strings';\nimport { isPrimitive } from './helpers';\nimport {\n  DEFAULT_DECOMPOSE_OPTIONS,\n  type Decompose,\n  type DecomposeOptions,\n} from './types.types';\n\nfunction ddecompose(\n  arg: any,\n  prev = '',\n  options: DecomposeOptions = DEFAULT_DECOMPOSE_OPTIONS,\n) {\n  const { object } = {\n    ...DEFAULT_DECOMPOSE_OPTIONS,\n    ...options,\n  };\n  const canAddObjectKeys = object === 'both' || object === 'object';\n  const canAddKeys = object === 'both' || object === 'key';\n\n  const _prev = prev ? prev + DELIMITER : '';\n  const output: [string, any][] = [];\n\n  const isArray = Array.isArray(arg);\n  if (isArray) {\n    if (canAddObjectKeys) output.push([`${prev}`, arg]);\n\n    arg.forEach((item, index) => {\n      const values = ddecompose(item, `${_prev}[${index}]`, options);\n      output.push(...values);\n    });\n    return output;\n  }\n\n  const isPrimit = isPrimitive(arg);\n  if (isPrimit) {\n    if (canAddKeys) output.push([`${prev}`, arg]);\n    return output;\n  }\n\n  if (canAddObjectKeys && prev !== '') output.push([`${prev}`, arg]);\n\n  const entries1 = Object.entries(arg);\n  entries1.forEach(([key, value]) => {\n    const values = ddecompose(value, `${_prev}${key}`, options);\n    output.push(...values);\n  });\n\n  return output;\n}\n\ntype Decompose_F = <T>(val: T, options?: DecomposeOptions) => Decompose<T>;\ntype _Decompose_F = (val: any, options?: DecomposeOptions) => any;\n\nexport type Decomposer = Decompose_F & {\n  strict: Decompose_F;\n  low: _Decompose_F;\n};\n\nconst _decompose: _Decompose_F = (val, options) => {\n  const entries1 = ddecompose(val, '', options);\n\n  const { sep, start } = {\n    ...DEFAULT_DECOMPOSE_OPTIONS,\n    ...options,\n  };\n  if (entries1.length == 0) return {};\n\n  const regex = new RegExp(DELIMITER, 'g');\n  const entries2 = entries1.map(([__key, value]) => {\n    const _key = __key.replace(regex, sep);\n    const key = start ? `${sep}${_key}` : _key;\n    return [key, value];\n  });\n\n  const output = Object.fromEntries(entries2);\n  return output;\n};\n\n/* v8 ignore next 1 */\nexport const decompose: Decomposer = (val, options) =>\n  _decompose(val, options);\ndecompose.low = _decompose;\ndecompose.strict = _decompose;\n"],"names":["DEFAULT_DECOMPOSE_OPTIONS","DELIMITER","isPrimitive"],"mappings":"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"}