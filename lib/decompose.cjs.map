{"version":3,"file":"decompose.cjs","sources":["../src/decompose.ts"],"sourcesContent":["import { DELIMITER } from './constants/strings';\nimport { isPrimitive } from './helpers';\nimport {\n  DEFAULT_DECOMPOSE_OPTIONS,\n  type Decompose,\n  type DecomposeOptions,\n} from './types.types';\n\nfunction ddecompose(\n  val: any,\n  prev = '',\n  options: DecomposeOptions = DEFAULT_DECOMPOSE_OPTIONS,\n) {\n  const { object } = {\n    ...DEFAULT_DECOMPOSE_OPTIONS,\n    ...options,\n  };\n  const canAddObjectKeys = object === 'both' || object === 'object';\n  const canAddKeys = object === 'both' || object === 'key';\n\n  const _prev = prev ? prev + DELIMITER : '';\n  const output: [string, any][] = [];\n  const entries1 = Object.entries(val);\n  entries1.forEach(([key, value]) => {\n    const isPrimit = isPrimitive(value) || Array.isArray(value);\n    if (!isPrimit) {\n      const values = ddecompose(value, `${_prev}${key}`, options);\n      output.push(...values);\n\n      if (canAddObjectKeys) {\n        output.push([`${_prev}${key}`, value]);\n      }\n    } else if (canAddKeys) output.push([`${_prev}${key}`, value]);\n  });\n  return output;\n}\n\ntype Decompose_F = <T>(val: T, options?: DecomposeOptions) => Decompose<T>;\ntype _Decompose_F = (val: any, options?: DecomposeOptions) => any;\n\nexport type Decomposer = Decompose_F & {\n  strict: Decompose_F;\n  low: _Decompose_F;\n};\n\nconst _decompose: _Decompose_F = (val, options) => {\n  const entries1 = ddecompose(val, '', options);\n\n  const { sep, start } = {\n    ...DEFAULT_DECOMPOSE_OPTIONS,\n    ...options,\n  };\n  if (entries1.length == 0) return {};\n\n  const regex = new RegExp(DELIMITER, 'g');\n  const entries2 = entries1.map(([__key, value]) => {\n    const _key = __key.replace(regex, sep);\n    const key = start ? `${sep}${_key}` : _key;\n    return [key, value];\n  });\n\n  const output = Object.fromEntries(entries2);\n  return output;\n};\n\n/* v8 ignore next 1 */\nexport const decompose: Decomposer = (val, options) =>\n  _decompose(val, options);\ndecompose.low = _decompose;\ndecompose.strict = _decompose;\n"],"names":["DEFAULT_DECOMPOSE_OPTIONS","DELIMITER","isPrimitive"],"mappings":";;;;;;AAQA,SAAS,UAAU,CACjB,GAAQ,EACR,IAAI,GAAG,EAAE,EACT,OAAA,GAA4BA,qCAAyB,EAAA;IAErD,MAAM,EAAE,MAAM,EAAE,GAAG;AACjB,QAAA,GAAGA,qCAAyB;AAC5B,QAAA,GAAG,OAAO;KACX;IACD,MAAM,gBAAgB,GAAG,MAAM,KAAK,MAAM,IAAI,MAAM,KAAK,QAAQ;IACjE,MAAM,UAAU,GAAG,MAAM,KAAK,MAAM,IAAI,MAAM,KAAK,KAAK;AAExD,IAAA,MAAM,KAAK,GAAG,IAAI,GAAG,IAAI,GAAGC,2BAAS,GAAG,EAAE;IAC1C,MAAM,MAAM,GAAoB,EAAE;IAClC,MAAM,QAAQ,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC;IACpC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,KAAI;AAChC,QAAA,MAAM,QAAQ,GAAGC,mBAAW,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC;QAC3D,IAAI,CAAC,QAAQ,EAAE;AACb,YAAA,MAAM,MAAM,GAAG,UAAU,CAAC,KAAK,EAAE,CAAA,EAAG,KAAK,CAAA,EAAG,GAAG,CAAA,CAAE,EAAE,OAAO,CAAC;AAC3D,YAAA,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;YAEtB,IAAI,gBAAgB,EAAE;AACpB,gBAAA,MAAM,CAAC,IAAI,CAAC,CAAC,CAAA,EAAG,KAAK,CAAA,EAAG,GAAG,CAAA,CAAE,EAAE,KAAK,CAAC,CAAC;YACxC;QACF;AAAO,aAAA,IAAI,UAAU;AAAE,YAAA,MAAM,CAAC,IAAI,CAAC,CAAC,CAAA,EAAG,KAAK,CAAA,EAAG,GAAG,CAAA,CAAE,EAAE,KAAK,CAAC,CAAC;AAC/D,IAAA,CAAC,CAAC;AACF,IAAA,OAAO,MAAM;AACf;AAUA,MAAM,UAAU,GAAiB,CAAC,GAAG,EAAE,OAAO,KAAI;IAChD,MAAM,QAAQ,GAAG,UAAU,CAAC,GAAG,EAAE,EAAE,EAAE,OAAO,CAAC;AAE7C,IAAA,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG;AACrB,QAAA,GAAGF,qCAAyB;AAC5B,QAAA,GAAG,OAAO;KACX;AACD,IAAA,IAAI,QAAQ,CAAC,MAAM,IAAI,CAAC;AAAE,QAAA,OAAO,EAAE;IAEnC,MAAM,KAAK,GAAG,IAAI,MAAM,CAACC,2BAAS,EAAE,GAAG,CAAC;AACxC,IAAA,MAAM,QAAQ,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,EAAE,KAAK,CAAC,KAAI;QAC/C,MAAM,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;AACtC,QAAA,MAAM,GAAG,GAAG,KAAK,GAAG,CAAA,EAAG,GAAG,CAAA,EAAG,IAAI,CAAA,CAAE,GAAG,IAAI;AAC1C,QAAA,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC;AACrB,IAAA,CAAC,CAAC;IAEF,MAAM,MAAM,GAAG,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC;AAC3C,IAAA,OAAO,MAAM;AACf,CAAC;AAED;AACO,MAAM,SAAS,GAAe,CAAC,GAAG,EAAE,OAAO,KAChD,UAAU,CAAC,GAAG,EAAE,OAAO;AACzB,SAAS,CAAC,GAAG,GAAG,UAAU;AAC1B,SAAS,CAAC,MAAM,GAAG,UAAU;;;;"}